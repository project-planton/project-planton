---
alwaysApply: false
---

RULE NUMBER
021

TITLE
Forge: Generate Pulumi Module Overview (iac/pulumi/overview.md)

ROLE
You are the Project Planton Code Partner working inside the developer's local workspace in Cursor. This rule generates the module architecture overview document for the Pulumi implementation.

SCOPE
- Target: `apis/org/project_planton/provider/<provider>/<kindfolder>/v1/iac/pulumi/overview.md`
- Document Pulumi module architecture
- Explain design decisions
- Show resource relationships

PURPOSE
The overview document explains the Pulumi module's internal architecture to developers who want to understand or customize the implementation.

PREREQUISITES
- Pulumi module files exist (main.go, locals.go, outputs.go, resource files)
- spec.proto defines the configuration
- stack_outputs.proto defines outputs

SEQUENTIAL STEPS

1) **Analyze Module Structure**
   - Read `iac/pulumi/module/main.go` to understand the controller
   - Read `iac/pulumi/module/locals.go` to understand transformations
   - Read `iac/pulumi/module/outputs.go` to understand output mapping
   - Read resource-specific files to understand what's provisioned

2) **Generate Overview Document**
   
   Create a document with the following sections:
   
   **Module Architecture**
   - High-level overview of the module structure
   - File organization and responsibilities
   - Entry point and control flow
   
   **Key Components**
   - **Controller (main.go)**: What it orchestrates
   - **Locals (locals.go)**: What transformations it performs
   - **Outputs (outputs.go)**: What it exposes
   - **Resource Files**: What each resource file creates
   
   **Resource Relationships**
   - ASCII diagram or text description showing:
     - Input: spec.proto fields
     - Processing: locals transformations
     - Resources: what gets created
     - Dependencies: explicit and implicit
     - Output: stack_outputs.proto fields
   
   **Data Flow**
   ```
   StackInput (spec + credentials)
      ↓
   Locals (transformations)
      ↓
   Resources (provisioning)
      ↓
   Outputs (structured results)
   ```
   
   **Design Decisions**
   - Why certain resources were chosen
   - Why resources are organized this way
   - Trade-offs made
   - Provider-specific considerations
   
   **Customization Guide**
   - How to fork and modify
   - Which files to change for common customizations
   - How to maintain compatibility with spec.proto
   
   **Common Patterns**
   - Naming conventions
   - Label/tag management
   - Credential handling
   - Error handling

3) **Content Quality**
   - **Length**: 50-200 lines (concise but comprehensive)
   - **Technical**: Focus on architecture, not usage
   - **Visual**: Use ASCII diagrams where helpful
   - **Practical**: Include customization guidance

4) **Write the Document**
   
   Create the file at: `apis/org/project_planton/provider/<provider>/<kindfolder>/v1/iac/pulumi/overview.md`

SUCCESS CRITERIA
- File exists at correct path
- Contains architecture explanation
- Shows resource relationships
- Explains design decisions
- Provides customization guidance

OUTPUT
- Confirm file created
- Show main sections included
- List key architectural points captured

NOTES
- This is a "nice to have" not "must have"
- Helps developers understand the implementation
- Useful for platform engineers who want to customize
- Not needed for basic usage (that's what README.md is for)
- Focus on "why" and "how it works" not "how to use"
