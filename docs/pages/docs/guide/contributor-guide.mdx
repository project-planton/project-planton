Welcome to the ProjectPlanton Contributor Guide! This guide is designed to help developers and DevOps engineers get
started with contributing to ProjectPlanton. Whether you're interested in becoming a maintainer or simply contributing
code, this guide will walk you through the steps necessary to make meaningful contributions to the project.

Before you begin, it's essential to have a basic understanding of ProjectPlanton's goals, architecture, and components.
We highly recommend watching our Restaurant Analogy video series, where we explain the core concepts of ProjectPlanton
using the analogy of a restaurant.

## Video Series - Restaurant Analogy

<details>
  <summary>Introduction</summary>
  <iframe width="640" height="360" src="https://www.loom.com/embed/31f71a8a728849bc82d1707eccda015c?sid=ef12ca21-b045-4c75-91f0-34a8070ca351" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</details>

<details>
  <summary>Twitter is FullMeal</summary>
  <iframe width="640" height="360" src="https://www.loom.com/embed/5ba8ba48b89f42bbac3d72dc60421e2b?sid=967419ee-c286-48f9-be56-1b8708dae925" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</details>

<details>
  <summary>Project-Planton - A New Ordering System</summary>
  <iframe width="640" height="360" src="https://www.loom.com/embed/ad2eaa54676f463d81cccb1a71c3a33d?sid=4c926f1a-84db-4460-8eee-0950f2de0377" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</details>

## Video Series - Project-Planton Three Pillars Deep Dive

<details>
  <summary>First Pillar - The APIs</summary>
  <iframe width="640" height="360" src="https://www.loom.com/embed/9ff75808e8824db5b161b55c2a6af5f7?sid=0c90a062-048e-462b-be02-b2f219c9744e" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</details>

<details>
  <summary>Second Pillar - The Pulumi Modules</summary>
  <iframe width="640" height="360" src="https://www.loom.com/embed/9ffce703c75f4afd811097e8f6e61978?sid=6857cb0a-9f70-4fea-98f9-7f585be516d5" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</details>

<details>
  <summary>Third Pillar - The CLI</summary>

  ### PART 1
  <br />

  <iframe width="640" height="360" src="https://www.loom.com/embed/f61ccec0c0d14d0ab0fa664113fd844a?sid=2544293b-2edf-4bd3-9883-7fa440ad6070" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>

  ### PART 2
  <br />

  <iframe width="640" height="360" src="https://www.loom.com/embed/70fc93e1d6aa4fb4b25ce5f13b51d7f8?sid=d191606b-0244-4300-a967-b92332443077" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>
</details>


**Please ensure you've watched these videos before proceeding.**

---

## Getting Started

- [How to Get Started as a Contributor Video](https://www.loom.com/share/077a490818bc4d28a0fd456a2320b253?sid=620d4d11-b5c5-477a-936f-68d1350b1aae)

### Prerequisites

Before contributing to ProjectPlanton, please ensure you have the following:

- **Understanding of ProjectPlanton**: Watch the Restaurant Analogy video series linked above.
- **Development Environment**:
    - **Golang**: ProjectPlanton is written in Golang. Install Golang by following the
      official [Golang installation guide](https://golang.org/doc/install).
    - **Pulumi**: Install Pulumi by following
      the [Pulumi installation instructions](https://www.pulumi.com/docs/get-started/install/).
    - **Git**: Ensure you have Git installed and configured.
    - **Code Editor**: We recommend using [GoLand](https://www.jetbrains.com/go/)
      or [Visual Studio Code](https://code.visualstudio.com/) with Go extensions.

### Contributor Types

- [GitHub Repos & Contributor Types Video](https://www.loom.com/share/7779b394ac9d4e3791ed6cdaabbe5e2f?sid=678084d4-9a11-4998-9611-25ae8ce71b1c)

There are two primary ways to contribute to ProjectPlanton:

1. **Maintainer**: As a maintainer, you have direct access to the ProjectPlanton repositories. Maintainers can create
   branches, push changes directly, and merge pull requests.
2. **Contributor**: As a contributor, you can contribute by forking the repositories, creating branches in your fork,
   and submitting pull requests to the main repository.

The workflows for maintainers and contributors differ slightly, which we'll explain in detail below.

---

## Contribution Overview

ProjectPlanton consists of three core components:

1. **APIs**: Defined using Protocol Buffers (protobufs), the APIs specify the inputs required by the Pulumi modules.
2. **Pulumi Modules**: Written in Golang, these modules define the infrastructure components to be deployed.
3. **CLI**: Also written in Golang, the CLI provides a command-line interface for users to interact with ProjectPlanton.

Depending on your interests and expertise, you can contribute to any of these components.

---

## Contributing as a Maintainer

If you're a maintainer, you have direct access to the repositories and can create branches and push changes without
forking.

### Repository Access

- **Organization**: [github.com/project-planton](https://github.com/project-planton)
- **CLI Repository**: [project-planton/project-planton](https://github.com/project-planton/project-planton)
- **Pulumi Modules**: Each Pulumi module is a separate repository within the organization, named using the pattern:
  `project-planton/<module-name>-pulumi-module` (e.g., `project-planton/s3-bucket-pulumi-module`).

### Workflow for Maintainers

1. **Clone the Repository**:
   ```bash
   git clone git@github.com:project-planton/project-planton.git
   ```
2. **Create a New Branch**:
   ```bash
   git checkout -b <feature-or-bugfix-branch>
   ```
3. **Make Changes**: Modify the code as needed.
4. **Test Your Changes**: See the specific sections below for testing changes to the CLI, Pulumi modules, or APIs.
5. **Commit and Push**:
   ```bash
   git add .
   git commit -m "Your commit message"
   git push origin <feature-or-bugfix-branch>
   ```
6. **Create a Pull Request**: Open a pull request against the `main` branch in the repository.
7. **Review and Merge**: After reviews, merge the pull request.

---

## Contributing as a Contributor

If you're a contributor without direct access, you'll need to fork the repository.

### Workflow for Contributors

1. **Fork the Repository**: Click the "Fork" button on the repository's GitHub page.
2. **Clone Your Fork**:
   ```bash
   git clone git@github.com:<your-username>/project-planton.git
   ```
3. **Add Upstream Remote**:
   ```bash
   git remote add upstream git@github.com:project-planton/project-planton.git
   ```
4. **Create a New Branch**:
   ```bash
   git checkout -b <feature-or-bugfix-branch>
   ```
5. **Make Changes**: Modify the code as needed.
6. **Test Your Changes**: See the specific sections below for testing changes to the CLI, Pulumi modules, or APIs.
7. **Commit and Push**:
   ```bash
   git add .
   git commit -m "Your commit message"
   git push origin <feature-or-bugfix-branch>
   ```
8. **Create a Pull Request**: Go to your fork on GitHub and create a pull request against the `main` branch of the
   original repository.
9. **Address Reviews**: Respond to any review comments and make necessary changes.
10. **Wait for Merge**: A maintainer will merge your pull request after approval.

---

## Contributing to the CLI

### Overview

The ProjectPlanton CLI is written in Golang and uses the Cobra package for command-line tools. You can contribute by
improving the user experience, adding new commands, or fixing bugs.

[Hands-On Video: Contributing to the CLI](https://www.loom.com/share/53b8c36e2b4e4a4ba125fe505bb4ee00?sid=a2c41ae9-36f7-48a2-ae1a-0544579438ed)

### Steps to Contribute to the CLI

#### 1. Clone the Repository

For maintainers:

```bash
git clone git@github.com:project-planton/project-planton.git
```

For contributors:

```bash
git clone git@github.com:<your-username>/project-planton.git
git remote add upstream git@github.com:project-planton/project-planton.git
```

#### 2. Create a New Branch

```bash
git checkout -b <your-feature-branch>
```

#### 3. Make Changes

- Navigate to the `cmd/projectplanton` directory. Each command has its own `.go` file.
- For example, to modify the `load manifest` command, edit `loadManifest.go`.
- Add or modify code as needed.

#### 4. Test Your Changes

- Ensure Golang is installed.
- Run the CLI locally:

  ```bash
  go run main.go <your-command>
  ```

- Alternatively, you can build the binary:

  ```bash
  make local
  ```

  This places the binary in your local `~/bin` directory.

- Test your changes by running the command:

  ```bash
  projectplanton <your-command>
  ```

#### 5. Commit and Push

```bash
git add .
git commit -m "Describe your changes"
git push origin <your-feature-branch>
```

#### 6. Create a Pull Request

- Go to GitHub and create a pull request against the `main` branch.

---

## Contributing to Pulumi Modules

### Overview

Pulumi modules in ProjectPlanton define infrastructure components (deployment components). Each module corresponds to a
specific resource (e.g., AWS S3 bucket, AWS VPC).

[Hands-On Video: Contributing to Pulumi Modules](https://www.loom.com/share/c08bbc74c9a54f53b6ec113a8a4bda41?sid=2fa6946a-ebd1-466b-846d-2c83436c4eb5)

### Steps to Contribute to Pulumi Modules

#### 1. Clone the Pulumi Module Repository

For maintainers:

```bash
git clone git@github.com:project-planton/<module-name>-pulumi-module.git
```

For contributors:

```bash
git clone git@github.com:<your-username>/<module-name>-pulumi-module.git
git remote add upstream git@github.com:project-planton/<module-name>-pulumi-module.git
```

#### 2. Create a New Branch

```bash
git checkout -b <your-feature-branch>
```

#### 3. Make Changes

- Modify the Pulumi module code as needed.
- For example, you can update resource properties, fix bugs, or add new features.

#### 4. Test Your Changes

- Set up Pulumi to use a local state file:

  ```bash
  pulumi login file://~/.pulumi
  ```

- Run Pulumi commands to test your module:

  ```bash
  pulumi up
  ```

- To use your local module instead of the one from GitHub, specify the `--module` flag when running the CLI:

  ```bash
  projectplanton pulumi up --module /path/to/your/local/module
  ```

#### 5. Commit and Push

```bash
git add .
git commit -m "Describe your changes"
git push origin <your-feature-branch>
```

#### 6. Create a Pull Request

- Go to GitHub and create a pull request against the `main` branch.

---

## Contributing to the APIs

### Overview

ProjectPlanton uses Protocol Buffers (protobufs) to define APIs that specify the inputs required by Pulumi modules.
Changes to the APIs are necessary when you need to accept new inputs or modify existing ones.

[Hands-On Video: Contributing to the APIs](https://www.loom.com/share/250579bb44b64adb9b312d0386aef069?sid=3c9023b8-fb10-4c0f-99f2-120688c98dfd)

### Steps to Contribute to the APIs

#### 1. Clone the CLI Repository (APIs are co-located)

For maintainers:

```bash
git clone git@github.com:project-planton/project-planton.git
```

For contributors:

```bash
git clone git@github.com:<your-username>/project-planton.git
git remote add upstream git@github.com:project-planton/project-planton.git
```

#### 2. Create a New Branch

```bash
git checkout -b <your-feature-branch>
```

#### 3. Modify Protobuf Files

- Navigate to the `apis` directory within the repository.
- Find the relevant `.proto` file for the resource you wish to modify.
    - For example: `apis/projectplanton/provider/aws/vpc/spec.proto`
- Add or modify fields as needed.
    - Ensure you increment the field numbers correctly.

Example:

```protobuf
string alias_name = 8; // This field is being added for demo purposes only.
```

#### 4. Build and Generate Code

- Run the build command to generate the Go code from the protobuf definitions:

  ```bash
  make build
  ```

#### 5. Update Pulumi Modules to Use New APIs

- If the changes affect Pulumi modules, you'll need to update them as well.
- Clone the relevant Pulumi module repository.
- In the module's `go.mod` file, temporarily replace the dependency to use your local version:

  ```go
  replace github.com/project-planton/project-planton => /path/to/your/local/project-planton
  ```

- Update the module code to use the new API fields.

#### 6. Test Your Changes

- Build and test the CLI with your changes:

  ```bash
  go run main.go <your-command>
  ```

- Ensure that the Pulumi modules work correctly with the new APIs.

#### 7. Commit and Push

- Commit changes in both the CLI (APIs) and Pulumi module repositories.
- Push your branches to your forks or the origin.

#### 8. Create Pull Requests

- Create pull requests for both the CLI and Pulumi module changes.
- Reference each pull request in the other for clarity.

---

## Releasing Changes (Maintainers Only)

### Releasing a New Version of the CLI

After merging changes to the `main` branch, you can release a new version:

1. **Tag the Release**:

   ```bash
   git tag -a vX.Y.Z -m "Release version X.Y.Z"
   git push origin vX.Y.Z
   ```

2. **Create a GitHub Release**: Go to GitHub and draft a new release based on the tag.

3. **Update Homebrew Tap**: If applicable, update the Homebrew tap to point to the new version.

### Updating Pulumi Module Dependencies

- After releasing a new version of the CLI (which includes the APIs), update the Pulumi modules to use the new version.
- In the module's `go.mod` file, update the dependency:

  ```go
  require github.com/project-planton/project-planton vX.Y.Z
  ```

- Commit and push the changes, then create a pull request.

---

## Conclusion

Thank you for your interest in contributing to ProjectPlanton! We appreciate your efforts to improve the project. If you
have any questions or need assistance, please reach out via GitHub issues or contact one of the maintainers.