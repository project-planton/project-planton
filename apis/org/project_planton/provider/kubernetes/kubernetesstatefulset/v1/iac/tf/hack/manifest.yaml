# Example manifest for testing KubernetesStatefulSet Terraform module
apiVersion: kubernetes.project-planton.org/v1
kind: KubernetesStatefulSet
metadata:
  name: postgres-db
spec:
  namespace: database
  create_namespace: true
  container:
    app:
      image:
        repo: postgres
        tag: "15"
      resources:
        limits:
          cpu: "1000m"
          memory: "2Gi"
        requests:
          cpu: "100m"
          memory: "256Mi"
      ports:
        - name: postgres
          containerPort: 5432
          servicePort: 5432
          networkProtocol: TCP
          appProtocol: tcp
          isIngressPort: false
      env:
        variables:
          POSTGRES_DB: myapp
        secrets:
          POSTGRES_PASSWORD: supersecret
      volumeMounts:
        - name: data
          mountPath: /var/lib/postgresql/data
  availability:
    replicas: 3
  volumeClaimTemplates:
    - name: data
      size: 10Gi
      accessModes:
        - ReadWriteOnce
  podManagementPolicy: OrderedReady
