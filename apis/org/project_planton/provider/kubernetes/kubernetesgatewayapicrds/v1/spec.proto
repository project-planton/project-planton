syntax = "proto3";

package org.project_planton.provider.kubernetes.kubernetesgatewayapicrds.v1;

import "buf/validate/validate.proto";
import "org/project_planton/provider/kubernetes/target_cluster.proto";
import "org/project_planton/shared/options/options.proto";

// KubernetesGatewayApiCrdsSpec defines configuration for installing the
// Kubernetes Gateway API CRDs on any Kubernetes cluster.
//
// The Gateway API is the next-generation Kubernetes API for managing ingress
// and service mesh traffic. Installing these CRDs enables Gateway, HTTPRoute,
// GRPCRoute, and other Gateway API resources to be used in the cluster.
message KubernetesGatewayApiCrdsSpec {
  // Target Kubernetes Cluster where the Gateway API CRDs will be installed.
  org.project_planton.provider.kubernetes.KubernetesClusterSelector target_cluster = 1;

  // Gateway API version to install (e.g., "v1.2.1", "v1.3.0").
  // Defaults to v1.2.1 if not specified.
  // Must start with 'v' followed by a valid semver version.
  optional string version = 2 [
    (org.project_planton.shared.options.default) = "v1.2.1",
    (buf.validate.field).string = {
      min_len: 1
      pattern: "^v[0-9]+\\.[0-9]+\\.[0-9]+(-[a-zA-Z0-9]+)?$"
    }
  ];

  // Installation channel determines which set of CRDs to install.
  // The standard channel includes stable Gateway API resources.
  // The experimental channel includes additional experimental resources.
  message InstallChannel {
    enum GatewayApiInstallChannel {
      gateway_api_install_channel_unspecified = 0;
      // Standard channel: Gateway, GatewayClass, HTTPRoute, ReferenceGrant
      standard = 1;
      // Experimental channel: Includes all standard resources plus
      // TCPRoute, UDPRoute, TLSRoute, GRPCRoute (experimental versions)
      experimental = 2;
    }
    GatewayApiInstallChannel channel = 1 [(buf.validate.field).enum.defined_only = true];
  }

  // Installation channel for Gateway API CRDs.
  // Defaults to standard channel if not specified.
  InstallChannel install_channel = 3;
}
