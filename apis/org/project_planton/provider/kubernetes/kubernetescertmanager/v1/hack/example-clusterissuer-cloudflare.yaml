# ClusterIssuers Created Automatically by KubernetesCertManager Addon
#
# The KubernetesCertManager addon automatically creates ONE ClusterIssuer PER DOMAIN
# based on the dns_providers configuration in the KubernetesCertManagerSpec.
# Each ClusterIssuer is named after the domain for better visibility.
#
# You DO NOT need to manually create ClusterIssuers when using this addon.
# Simply reference the domain name (e.g., "planton.cloud") in your Certificate resources.
#
# Example configuration:
# dnsProviders:
#   - name: cloudflare-planton
#     dnsZones:
#       - planton.cloud
#       - planton.live
#     cloudflare:
#       apiToken: ...
#
# Creates TWO ClusterIssuers:
# ---
# apiVersion: kubernetes-cert-manager.io/v1
# kind: ClusterIssuer
# metadata:
#   name: planton.cloud  # Named after the domain
# spec:
#   acme:
#     email: admin@planton.cloud  # From spec.acme.email
#     server: https://acme-v02.api.letsencrypt.org/directory  # From spec.acme.server
#     privateKeySecretRef:
#       name: letsencrypt-planton.cloud-account-key
#     solvers:
#       - dns01:
#           cloudflare:
#             apiTokenSecretRef:
#               name: kubernetes-cert-manager-cloudflare-planton-credentials
#               key: api-token
# ---
# apiVersion: kubernetes-cert-manager.io/v1
# kind: ClusterIssuer
# metadata:
#   name: planton.live  # Named after the domain
# spec:
#   acme:
#     email: admin@planton.cloud
#     server: https://acme-v02.api.letsencrypt.org/directory
#     privateKeySecretRef:
#       name: letsencrypt-planton.live-account-key
#     solvers:
#       - dns01:
#           cloudflare:
#             apiTokenSecretRef:
#               name: kubernetes-cert-manager-cloudflare-planton-credentials
#               key: api-token

---
# Example Certificate resource using the auto-created ClusterIssuer
apiVersion: kubernetes-cert-manager.io/v1
kind: Certificate
metadata:
  name: planton-cloud-wildcard
  namespace: default
spec:
  # Secret name where the TLS certificate will be stored
  secretName: planton-cloud-tls
  
  # Reference to the auto-created ClusterIssuer (named after the domain)
  issuerRef:
    name: planton.cloud  # Use the domain name as the issuer name
    kind: ClusterIssuer
  
  # DNS names for the certificate
  dnsNames:
    - planton.cloud
    - "*.planton.cloud"  # Wildcard subdomain
  
  # Certificate renewal settings
  renewBefore: 720h  # 30 days before expiry

---
# Example for planton.live domain
apiVersion: kubernetes-cert-manager.io/v1
kind: Certificate
metadata:
  name: planton-live-wildcard
  namespace: default
spec:
  secretName: planton-live-tls
  
  issuerRef:
    name: planton.live  # Use the domain name as the issuer name
    kind: ClusterIssuer
  
  dnsNames:
    - planton.live
    - "*.planton.live"
  
  renewBefore: 720h
