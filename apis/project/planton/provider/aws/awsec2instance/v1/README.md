# AwsEc2Instance

Provision a single AWS EC2 virtual machine instance with networking, IAM, and access configuration. This resource focuses on the 80/20 fields needed for typical production instances.

## Spec fields (summary)
- instance_name: Name of the EC2 instance.
- ami_id: AMI ID to launch (e.g., ami-0123456789abcdef0).
- instance_type: EC2 instance type (e.g., t3.small, m5.large).
- subnet_id: Target subnet (usually a private subnet). Accepts literal or ref.
- security_group_ids: One or more security groups. Accepts literal or ref.
- connection_method: Access method. One of SSM (default), BASTION, INSTANCE_CONNECT.
  - If SSM: require iam_instance_profile_arn.
  - If BASTION or INSTANCE_CONNECT: require key_name.
- iam_instance_profile_arn: IAM instance profile ARN (for SSM or other permissions).
- key_name: EC2 key pair name (required for BASTION/INSTANCE_CONNECT).
- root_volume_size_gb: Root volume size in GiB (default 30).
- ebs_optimized: Enable EBS optimization when supported by the instance type.
- disable_api_termination: Enable termination protection to prevent accidental deletion.
- tags: Map of tags to apply to the instance.
- user_data: User data script (up to 32 KiB).

## Stack outputs
- instance_id: EC2 instance ID.
- private_ip: Primary private IPv4 address.
- private_dns_name: Private DNS name within the VPC.
- availability_zone: Availability Zone of the instance.
- instance_profile_arn: Attached instance profile ARN (if any).
- ssh_private_key: Base64-encoded PEM private key when a key pair is generated by the module.
- ssh_public_key: OpenSSH-formatted public key corresponding to the generated private key.

## How it works
- This resource is provisioned via IaC backends supported by the CLI (Pulumi or Terraform/Tofu) within this repository. The stack input wires provisioner choice, stack metadata, the target resource, and provider credentials.

## References
- AWS EC2 Instances: https://docs.aws.amazon.com/ec2/
- Instance Connect: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/connect-using-ec2-instance-connect.html
- Systems Manager Session Manager: https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html
