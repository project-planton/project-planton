syntax = "proto3";

package project.planton.provider.cloudflare.cloudflarezerotrustaccessapplication.v1;

import "buf/validate/validate.proto";
import "project/planton/shared/foreignkey/v1/foreign_key.proto";

/**
 * **CloudflareZeroTrustAccessApplicationSpec** defines the configuration for a Cloudflare Zero Trust Access Application.
 * This resource configures a Zero Trust access policy for a specific hostname within a Cloudflare DNS zone.
 * It includes settings for who can access the application and how (e.g., allowed emails, MFA requirements).
 */
message CloudflareZeroTrustAccessApplicationSpec {
  // The display name of the Zero Trust Access Application.
  string application_name = 1 [
    (buf.validate.field).string.min_len = 1
  ];

  // The Cloudflare DNS zone ID (from a CloudflareDnsZone resource) for the domain.
  string zone_id = 2 [
    (buf.validate.field).required = true,
    (project.planton.shared.foreignkey.v1.default_kind) = CloudflareDnsZone,
  (project.planton.shared.foreignkey.v1.default_kind_field_path) = "status.outputs.zone_id"
  ];

  // The fully qualified domain name to protect (e.g., "app.example.com").
  string hostname = 3 [
    (buf.validate.field).required = true
  ];

  // The type of access policy for this application (ALLOW or BLOCK). Defaults to ALLOW if unspecified.
  CloudflareZeroTrustPolicyType policy_type = 4;

  // A list of email addresses that are allowed access (applicable only when policy_type = ALLOW).
  repeated string allowed_emails = 5;

  // The duration of each authenticated session, in minutes (default: 1440 minutes, i.e., 24 hours).
  int32 session_duration_minutes = 6;

  // Whether multi-factor authentication (MFA) is required for access.
  bool require_mfa = 7;

  // A list of allowed Google Workspace group email addresses (optional).
  repeated string allowed_google_groups = 8;
}

/** Types of access policies for Cloudflare Zero Trust Access Applications. */
enum CloudflareZeroTrustPolicyType {
  ALLOW = 0;
  BLOCK = 1;
}
