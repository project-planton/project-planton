syntax = "proto3";

package project.planton.credential.gcpcredential.v1;

import "buf/validate/validate.proto";

// GcpCredentialSpec message represents the specification required to create or connect a Google Cloud Platform (GCP)
// account on the Planton Cloud Platform.
// This message consolidates all necessary input parameters to establish a connection with a GCP account,
// ensuring accurate configuration and validation of credentials.
// Fields include details like GCP organization ID and service account key, providing a complete set of information
// for securely connecting to GCP.
// Detailed validation rules have been applied to these fields to ensure input correctness and adherence to
// security protocols.
message GcpCredentialSpec {
  // The Google Cloud Organization ID, which uniquely identifies the GCP organization.
  // This is a mandatory field and must be a numeric string.
  // The value cannot be empty and must only contain numbers (0-9).
  // For more information, visit: https://cloud.google.com/resource-manager/docs/creating-managing-organization
  string gcp_organization_id = 1 [
    (buf.validate.field).required = true,
    (buf.validate.field).ignore_empty = true,
    (buf.validate.field).cel = {
      id: "spec.gcp.org_id",
      message: "Only numbers (0-9) are allowed",
      expression: "this.matches('^[0-9]+$')"
    }
  ];

  // The base64 encoded Google Service Account Key, which is used to authenticate API requests to GCP services.
  // This is a required field, and the value must be a valid base64 encoded string.
  string service_account_key_base64 = 2 [
    (buf.validate.field).required = true
  ];
}
